# Plano de Teste para Model de Evento (Sprint 5)

| Funcionalidade                          | Comportamento Esperado                                                                  | Verificações                                                        | Critérios de Aceite                                                                                  |
|----------------------------------------|------------------------------------------------------------------------------------------|----------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------|
| Criação válida de evento               | Deve permitir salvar um evento completo com todos os campos obrigatórios                | Criar um evento com dados válidos (título, descrição, data, etc.)   | Evento é salvo com sucesso; campos como `_id`, `eventoCriadoEm` são gerados automaticamente          |
| Campo status (enum)                    | Aceita apenas "ativo" ou "inativo" como status                                          | Criar eventos com status: ativo e inativo                           | Ambos os valores são salvos com sucesso                                                               |
| Status inválido                        | Deve falhar se for passado um valor fora do enum                                        | Criar evento com status: "teste"                                    | Gera erro de validação de enumeração                                                                  |
| Campo obrigatório titulo               | Campo obrigatório                                                                       | Omitir `titulo` ao criar evento                                     | Gera erro de validação                                                                                 |
| Campo obrigatório descricao            | Campo obrigatório                                                                       | Omitir `descricao`                                                  | Gera erro de validação                                                                                 |
| Campo obrigatório local                | Campo obrigatório                                                                       | Omitir `local`                                                      | Gera erro de validação                                                                                 |
| Campo obrigatório dataEvento           | Campo obrigatório e deve ser tipo Date                                                  | Enviar string ou omitir campo                                       | Gera erro de tipo ou de ausência                                                                       |
| Subdocumento organizador              | Deve conter um `_id` válido e um nome                                                   | Testar com `_id` inválido ou ausente                                | Gera erro de referência inválida ou ausência                                                           |
| Campo linkInscricao                   | Deve ser uma URL válida                                                                 | Enviar URL inválida                                                 | Gera erro de validação                                                                                 |
| Campo tags                             | Deve ser array de strings (mínimo 1 item)                                               | Enviar array vazio ou não array                                     | Gera erro de validação                                                                                 |
| Campo categoria                        | Obrigatório, tipo string                                                                | Omitir campo ou enviar string vazia                                 | Gera erro de validação                                                                                 |
| Campos de mídia (capa, carrossel, vídeo) | Devem conter ao menos um objeto com altura, largura, url, tamanhoMb                    | Enviar array vazio ou objetos incompletos                           | Gera erro de validação                                                                                 |
| Autopreenchimento eventoCriadoEm      | Deve ser preenchido automaticamente ao salvar                                           | Criar evento sem o campo e verificar após o save                    | Campo preenchido automaticamente como instância de `Date`                                             |
| Relacionamento com usuários           | O campo `organizador._id` deve referenciar um usuário existente                         | Criar evento com referência inexistente ou inválida                 | Erro ou falha de integridade                                                                           |
| Isolamento entre testes               | Cada teste deve ser independente dos demais                                             | Verificar uso de `deleteMany()` e `jest.clearAllMocks()`            | Os testes rodam com banco em memória limpo                                                             |

# Plano de Teste para Schema Zod - Evento (Sprint 5)

| Funcionalidade                      | Comportamento Esperado                                                                     | Verificações                                              | Critérios de Aceite                                                                                  |
|------------------------------------|----------------------------------------------------------------------------------------------|------------------------------------------------------------|--------------------------------------------------------------------------------------------------------|
| Validação completa (EventoSchema)  | Deve aceitar objeto completo com todos os campos válidos                                    | Usar `.parse(dadosValidos)`                               | Retorna objeto validado corretamente                                                                  |
| Campo titulo obrigatório e string  | Deve falhar se ausente ou não for string                                                    | Enviar `titulo: ""` ou não enviar                         | Gera erro com mensagem personalizada                                                                  |
| Campo descricao obrigatório        | Deve ser string não vazia                                                                   | Enviar `descricao: ""` ou omitir                          | Gera erro de validação                                                                                 |
| Campo local obrigatório            | Deve ser string não vazia                                                                   | Enviar `local: ""` ou omitir                              | Gera erro                                                                                              |
| Campo dataEvento como Date         | Deve converter string ISO para `Date` válida                                                | Usar `.coerce.date()` com string                          | Campo é aceito e convertido corretamente                                                               |
| Campo organizador como objeto      | Deve conter `_id` (ObjectId) e `nome` como string                                           | Omitir `_id`, ou `nome`, ou ambos                         | Erro de validação detalhada                                                                           |
| Campo linkInscricao                | Deve ser uma URL válida                                                                     | Enviar string inválida como `"not_a_url"`                | Gera erro com mensagem de URL inválida                                                                |
| Campo tags                         | Deve conter pelo menos uma string válida                                                    | Enviar `[]` ou `[123]`                                    | Gera erro de array vazio ou tipo inválido                                                             |
| Campo categoria obrigatório        | Deve ser string                                                                              | Omitir ou enviar `""`                                     | Gera erro                                                                                              |
| Campo status enum                  | Aceita apenas "ativo" ou "inativo"                                                           | Enviar valor fora do enum                                 | Gera erro de enum inválido                                                                            |
| Campos de mídia (capa, vídeo, carrossel) | Cada item deve conter `url`, `tamanhoMb`, `altura`, `largura` com tipos corretos   | Enviar objeto incompleto ou tipos errados                | Gera erros específicos por campo                                                                      |
| Validação negativa: campos ausentes | Deve rejeitar evento com campos obrigatórios ausentes                                       | Mock com campos como `descricao`, `local`, etc. ausentes | Validações falham com mensagens personalizadas                                                        |

# Plano de Teste para Controller de Evento (Sprint 5)

| Funcionalidade                     | Comportamento Esperado                                                                       | Verificações                                             | Critérios de Aceite                                                                                  |
|-----------------------------------|----------------------------------------------------------------------------------------------|----------------------------------------------------------|--------------------------------------------------------------------------------------------------------|
| Cadastro de evento                | Deve permitir o cadastro completo de evento                                                  | Enviar `req.body` com campos obrigatórios                | Retorna status 201, objeto salvo corretamente, mensagem de sucesso                                   |
| Validação com Zod (body inválido) | Deve falhar se o corpo da requisição estiver fora do schema                                  | Enviar campos inválidos ou faltando                      | Retorna erro estruturado com mensagem do Zod                                                          |
| Listagem geral de eventos         | Retorna todos os eventos cadastrados                                                         | Chamar `listar` sem `req.params.id`                      | Retorna status 200, array de eventos                                                     |
| Listagem por ID                   | Retorna evento específico pelo ID                                                            | Chamar `listar` com `req.params.id`                      | Retorna status 200 e objeto completo do evento                                                       |
| Erro ao listar evento inexistente | Deve lançar erro se o evento não for encontrado                                              | Enviar ID inexistente                                    | Retorna erro com status 404                                                                          |
| Atualização de evento             | Atualiza campos permitidos do evento pelo ID                                                 | Enviar ID e `req.body` com campos válidos                | Retorna status 200 e dados atualizados                                                               |
| Exclusão de evento                | Remove evento existente com sucesso                                                          | Enviar ID válido                                         | Retorna status 200 com mensagem de confirmação                                                       |
| Falha ao deletar sem ID           | Deve lançar erro se o ID estiver ausente ou inválido                                         | Chamar `deletar` sem `req.params.id`                     | Lança `CustomError` com status 400                                                                   |
| Alteração de status               | Permite mudar entre `ativo` e `inativo`                                                      | Enviar PATCH com novo status                             | Evento atualizado com sucesso, status alterado                                                       |

# Plano de Teste para Service de Evento (Sprint 5)

| Funcionalidade                    | Comportamento Esperado                                                           | Verificações                       | Critérios de Aceite                                                                            |
|----------------------------------|-----------------------------------------------------------------------------------|------------------------------------|--------------------------------------------------------------------------------------------------|
| Cadastro de evento               | Cria evento se os dados forem válidos                                            | Chamar `cadastrar(dadosValidados)` | Evento salvo e retornado com sucesso                                                           |
| Validação de existência por ID   | Antes de alterar/excluir, garante que o evento exista                            | Chamar `ensureEventoExists(id)`    | Lança `CustomError` se não existir, continua se encontrar                                      |
| Listagem geral                   | Retorna todos os eventos cadastrados                                   | Chamar `listar(req)`          | Retorna array com dados dos eventos                                                               |
| Listagem por ID                  | Retorna evento específico pelo ID                                                | Chamar `listarPorId(id)`           | Retorna objeto completo do evento                                                              |
| Atualização completa/parcial    | Permite alterar quaisquer campos válidos                                         | Chamar `alterar(id, campos)`       | Retorna evento atualizado com sucesso                                                          |
| Exclusão de evento               | Remove evento existente após validação                                           | Chamar `deletar(id)`               | Evento é removido                                                                              |
| Alteração de status              | Altera somente o campo de status (ativo/inativo)                                 | Chamar `alterarStatus(id, status)` | Status atualizado com sucesso                                                                  |

# Plano de Teste para Repository de Evento (Sprint 5)

| Funcionalidade                   | Comportamento Esperado                                                        | Verificações                       | Critérios de Aceite                                                                            |
|----------------------------------|--------------------------------------------------------------------------------|------------------------------------|--------------------------------------------------------------------------------------------------|
| Cadastro de evento               | Salva evento completo com base nos dados recebidos                            | Chamar `cadastrar(dadosEvento)`    | Evento salvo corretamente no banco                                                              |
| Listagem total                | Retorna eventos com metadados                                     | Chamar `listar(req)`          | Retorna array de eventos e dados dos eventos                                                   |
| Listagem por ID                  | Busca evento existente por ID                                                  | Chamar `listarPorId(id)`           | Retorna objeto correspondente ao evento                                                         |
| Atualização de evento            | Altera os dados de um evento existente                                         | Chamar `alterar(id, parsedData)`   | Evento é atualizado e salvo com sucesso                                                         |
| Exclusão de evento               | Remove evento com base no ID                                                   | Chamar `deletar(id)`               | Evento é removido com sucesso                                                                   |
| Erro ao buscar evento inexistente| Deve lançar erro customizado se o evento não for encontrado                    | Simular ID inválido/inexistente    | Retorna `CustomError` com status 404                                                            |
| Atualização de status            | Atualiza apenas o campo `status` de um evento                                  | Chamar `alterarStatus(id, status)` | Campo `status` atualizado corretamente                                                           |